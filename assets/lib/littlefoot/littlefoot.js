!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).littlefoot={})}(this,(function(e){"use strict";var t=function(){return t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var n={};Object.defineProperty(n,"__esModule",{value:!0});var r=n.getStyle=void 0;r=n.getStyle=function(e,t){var n,r=((null===(n=e.ownerDocument)||void 0===n?void 0:n.defaultView)||window).getComputedStyle(e);return r.getPropertyValue(t)||r[t]};var i={};Object.defineProperty(i,"__esModule",{value:!0});var o=i.pixels=void 0,a=n,u=96,c=25.4;function l(e){return e?(0,a.getStyle)(e,"fontSize")||l(e.parentElement):(0,a.getStyle)(window.document.documentElement,"fontSize")}function s(e,t){e.classList.add(t)}function f(e,t){e.classList.remove(t)}function d(e){var t;null===(t=e.parentNode)||void 0===t||t.removeChild(e)}o=i.pixels=function e(t,n){var r,i,o=null!==(i=null===(r=null==n?void 0:n.ownerDocument)||void 0===r?void 0:r.defaultView)&&void 0!==i?i:window,a=o.document.documentElement||o.document.body,s=function(e){var t,n=e||"0",r=parseFloat(n),i=n.match(/[\d-.]+(\w+)$/);return[r,(null!==(t=null==i?void 0:i[1])&&void 0!==t?t:"").toLowerCase()]}(t),f=s[0];switch(s[1]){case"rem":return f*e(l(window.document.documentElement));case"em":return f*e(l(n),null==n?void 0:n.parentElement);case"in":return f*u;case"q":return f*u/c/4;case"mm":return f*u/c;case"cm":return f*u*10/c;case"pt":return f*u/72;case"pc":return f*u/6;case"vh":return(f*o.innerHeight||a.clientWidth)/100;case"vw":return(f*o.innerWidth||a.clientHeight)/100;case"vmin":return f*Math.min(o.innerWidth||a.clientWidth,o.innerHeight||a.clientHeight)/100;case"vmax":return f*Math.max(o.innerWidth||a.clientWidth,o.innerHeight||a.clientHeight)/100;default:return f}};var v="littlefoot__tooltip",m="is-";function p(e){var t=e.offsetHeight,n=e.getBoundingClientRect().top+t/2;return{above:n,below:window.innerHeight-n}}function h(e){var t=parseFloat(r(e,"marginLeft")),n=e.offsetWidth-t;return(e.getBoundingClientRect().left+n/2)/window.innerWidth}function g(e,t){var n=2*parseInt(r(e,"marginTop"),10)+e.offsetHeight;return t.below<n&&t.below<t.above?"above":"below"}var y="is-active",b="is-changing",w="is-scrollable",E=function(e){return!!e.parentElement};function H(e){var t=e.id,n=e.button,i=e.content,a=e.host,u=e.popover,c=e.wrapper,l=!1,H=0,x="above";return{id:t,activate:function(e){var t;n.setAttribute("aria-expanded","true"),s(n,b),s(n,y),n.insertAdjacentElement("afterend",u),u.style.maxWidth=document.body.clientWidth+"px",t=i,H=Math.round(o(r(t,"maxHeight"),t)),null==e||e(u,n)},dismiss:function(e){n.setAttribute("aria-expanded","false"),s(n,b),f(n,y),f(u,y),null==e||e(u,n)},isActive:function(){return n.classList.contains(y)},isReady:function(){return!n.classList.contains(b)},isHovered:function(){return l},ready:function(){s(u,y),f(n,b)},remove:function(){d(u),f(n,b)},reposition:function(){E(u)&&(i.style.maxHeight=function(e,t,n){var i=p(t),o=g(e,i),a=parseInt(r(e,"marginTop"),10);return Math.min(n,i[o]-a-15)}(u,n,H)+"px",x=function(e,t,n){var r=g(e,p(t));if(n!==r){f(e,m+n),s(e,m+r);var i=100*h(t)+"%",o="above"===r?"100%":"0";e.style.transformOrigin=i+" "+o}return r}(u,n,x),u.offsetHeight<i.scrollHeight?(s(u,w),i.setAttribute("tabindex","0")):(f(u,w),i.removeAttribute("tabindex")))},resize:function(){E(u)&&(u.style.left=function(e,t){var n=e.offsetWidth;return-h(t)*n+parseInt(r(t,"marginLeft"),10)+t.offsetWidth/2}(i,n)+"px",c.style.maxWidth=i.offsetWidth+"px",function(e,t){var n=e.querySelector("."+v);n&&(n.style.left=100*h(t)+"%")}(u,n))},startHovering:function(){l=!0},stopHovering:function(){l=!1},destroy:function(){return d(a)}}}var x={};Object.defineProperty(x,"__esModule",{value:!0});var S=x.throttle=void 0;S=x.throttle=function(e,t){void 0===t&&(t=0);var n,r=0;return Object.assign((function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var a=Math.max(0,r+t-Date.now());a?(clearTimeout(n),n=setTimeout((function(){r=Date.now(),e.apply(void 0,i)}),a)):(r=Date.now(),e.apply(void 0,i))}),{cancel:function(){r=0,clearTimeout(n)}})};var A=16,T="is-fully-scrolled",D=function(e){return function(t){var n=t.currentTarget,r=-t.deltaY;r>0&&f(e,T),n&&r<=0&&r<n.clientHeight+n.scrollTop-n.scrollHeight&&s(e,T)}};var _="littlefoot__content",M="littlefoot__wrapper",W="littlefoot--print",L="littlefoot",C=function(e){return s(e,W)};function O(e,t){return Array.from(e.querySelectorAll(t))}function P(e,t){return e.querySelector("."+t)||e.firstElementChild||e}function j(e){var t=document.createElement("div");return t.innerHTML=e,t.firstElementChild}function I(e){return void 0!==e}function R(e){var t=e.parentElement,n=function(e,t){return Array.from(e.children).filter((function(e){return 8!==e.nodeType&&e.matches(t)}))}(t,":not(."+W+")"),r=n.filter((function(e){return"HR"===e.tagName}));n.length===r.length&&(r.concat(t).forEach(C),R(t))}function z(e){var t=e.parentElement;d(e),t.innerHTML.replace("[]","").replace("&nbsp;"," ").trim()||z(t)}function k(e,t){var n=j(e.body.outerHTML);O(n,'[href$="#'+e.referenceId+'"]').forEach(z);var r=n.innerHTML.trim();return{original:e,data:{id:String(t+1),number:t+1,reference:"lf-"+e.referenceId,content:r.startsWith("<")?r:"<p>"+r+"</p>"}}}var q=function(e){var n=0,r=null;return function(i){var o=i.original,a=i.data,u=o.reference.closest(e);return n=r===u?n+1:1,r=u,{original:o,data:t(t({},a),{number:n})}}};function F(e){var t=/<%=?\s*(\w+?)\s*%>/g;return function(n){return e.replace(t,(function(e,t){var r;return String(null!==(r=n[t])&&void 0!==r?r:"")}))}}function B(e,t){var n=F(e),r=F(t);return function(e){var t=e.original,i=e.data,o=i.id,a=j('<span class="'.concat(L,'">').concat(n(i),"</span>")),u=a.firstElementChild;u.setAttribute("aria-expanded","false"),u.dataset.footnoteButton="",u.dataset.footnoteId=o;var c=j(r(i));c.dataset.footnotePopover="",c.dataset.footnoteId=o;var l=P(c,M),s=P(c,_);return function(e,t){e.addEventListener("wheel",S(D(t),A))}(s,c),{original:t,data:i,id:o,button:u,host:a,popover:c,content:s,wrapper:l}}}function V(e){var t=e.allowDuplicates,n=e.anchorParentSelector,r=e.anchorPattern,i=e.buttonTemplate,o=e.contentTemplate,a=e.footnoteSelector,u=e.numberResetSelector,c=e.scope,l=function(e,t,n){return O(e,n+' a[href*="#"]').filter((function(e){return(e.href+e.rel).match(t)}))}(document,r,c).map(function(e,t,n,r){var i=[];return function(o){var a=o.href.split("#")[1],u=O(e,"#"+window.CSS.escape(a)).find((function(e){return t||!i.includes(e)})),c=null==u?void 0:u.closest(r);if(c){i.push(c);var l=o.closest(n)||o;return{reference:l,referenceId:l.id||o.id,body:c}}}}(document,t,n,a)).filter(I).map(k).map(u?q(u):function(e){return e}).map(B(i,o)).map((function(e){return C(e.original.reference),C(e.original.body),R(e.original.body),e.original.reference.insertAdjacentElement("beforebegin",e.host),e})).map(H);return{footnotes:l,unmount:function(){l.forEach((function(e){return e.destroy()})),O(document,"."+W).forEach((function(e){return f(e,W)}))}}}var N={activateDelay:100,activateOnHover:!1,allowDuplicates:!0,allowMultiple:!1,anchorParentSelector:"sup",anchorPattern:/(fn|footnote|note)[:\-_\d]/gi,dismissDelay:100,dismissOnUnhover:!1,footnoteSelector:"li",hoverDelay:250,numberResetSelector:"",scope:"",contentTemplate:'<aside class="littlefoot__popover" id="fncontent:<% id %>"><div class="'.concat(M,'"><div class="').concat(_,'"><% content %></div></div><div class="').concat(v,'"></div></aside>'),buttonTemplate:'<button class="littlefoot__button" id="<% reference %>" title="See Footnote <% number %>"><svg role="img" aria-labelledby="title-<% reference %>" viewbox="0 0 31 6" preserveAspectRatio="xMidYMid"><title id="title-<% reference %>">Footnote <% number %></title><circle r="3" cx="3" cy="3" fill="white"></circle><circle r="3" cx="15" cy="3" fill="white"></circle><circle r="3" cx="27" cy="3" fill="white"></circle></svg></button>'};var U=16,Y="[data-footnote-id]",$=function(e,t){return e.target.closest(t)},G=function(e){return null==e?void 0:e.dataset.footnoteId},J=function(e,t){return function(n){var r=$(n,"[data-footnote-button]"),i=G(r);i?e(i):$(n,"[data-footnote-popover]")||t()}},K=function(e){return function(t){t.preventDefault();var n=$(t,Y),r=G(n);r&&e(r)}},Q=function(e){return function(t){27!==t.keyCode&&"Escape"!==t.key&&"Esc"!==t.key||e()}},X=document.addEventListener,Z=window.addEventListener,ee=function(e,t,n,r){X(e,(function(e){var r=e.target;(null==r?void 0:r.closest(t))&&n.call(r,e)}),r)};function te(e){void 0===e&&(e={});var n=t(t({},N),e),r=function(e,t){var n=e.footnotes,r=e.unmount,i=function(e){return function(n){n.isReady()&&(n.dismiss(t.dismissCallback),setTimeout(n.remove,e))}},o=function(e){return function(r){t.allowMultiple||n.filter((function(e){return e.id!==r.id})).forEach(i(t.dismissDelay)),r.isReady()&&(r.activate(t.activateCallback),r.reposition(),r.resize(),setTimeout(r.ready,e))}},a=function(e){return function(t){var r=n.find((function(e){return e.id===t}));r&&e(r)}};return{activate:function(e,t){return a(o(t))(e)},dismiss:function(e,t){return a(i(t))(e)},dismissAll:function(){return n.forEach(i(t.dismissDelay))},repositionAll:function(){return n.forEach((function(e){return e.reposition()}))},resizeAll:function(){return n.forEach((function(e){return e.resize()}))},toggle:a((function(e){return e.isActive()?i(t.dismissDelay)(e):o(t.activateDelay)(e)})),hover:a((function(e){e.startHovering(),t.activateOnHover&&!e.isActive()&&o(t.hoverDelay)(e)})),unhover:a((function(e){e.stopHovering(),t.dismissOnUnhover&&setTimeout((function(){return n.filter((function(e){return!e.isHovered()})).forEach(i(t.dismissDelay))}),t.hoverDelay)})),unmount:r}}(V(n),n),i=function(e){var t=new AbortController,n=t.signal,r=J(e.toggle,e.dismissAll),i=Q(e.dismissAll),o=S(e.repositionAll,U),a=S(e.resizeAll,U),u=K(e.hover),c=K(e.unhover);return X("touchend",r,{signal:n}),X("click",r,{signal:n}),X("keyup",i,{signal:n}),X("gestureend",o,{signal:n}),Z("scroll",o,{signal:n}),Z("resize",a,{signal:n}),ee("mouseover",Y,u,{signal:n}),ee("mouseout",Y,c,{signal:n}),function(){t.abort()}}(r);return{activate:function(e,t){void 0===t&&(t=n.activateDelay),r.activate(e,t)},dismiss:function(e,t){void 0===t&&(t=n.dismissDelay),void 0===e?r.dismissAll():r.dismiss(e,t)},unmount:function(){i(),r.unmount()},getSetting:function(e){return n[e]},updateSetting:function(e,t){n[e]=t}}}e.default=te,e.littlefoot=te,Object.defineProperty(e,"__esModule",{value:!0})}));
